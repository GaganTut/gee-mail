<html>
	<head>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
        <title>GEE-MAIL Coding Challenge</title>
    <script>
        window.onload = function () {
            // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
            // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser
           
            for (var z = 0 ; z < 10 ; z++) {
                addRow(window.geemails[z]);
            };
            var inboxCount = 10;
            document.getElementById('boxCount').innerHTML = inboxCount + " Geemails";

            function addRow(emails) {
                var newGeeRow = inbox.insertRow(1);

                var geeDateCol = newGeeRow.insertCell(0);
                var geeDate = document.createTextNode(emails.date);
                geeDateCol.appendChild(geeDate);

                var geeSubCol = newGeeRow.insertCell(1);
                var geeSub = document.createTextNode(emails.subject);
                geeSubCol.appendChild(geeSub);

                var geeSendCol = newGeeRow.insertCell(2);
                var geeSend = document.createTextNode(emails.sender);
                geeSendCol.appendChild(geeSend);

                var geeBtnCol = newGeeRow.insertCell(3);
                var bodyBtn = document.createElement('button');
                geeBtnCol.appendChild(bodyBtn);
                bodyBtn.innerHTML = "Open Message";
                bodyBtn.onclick = function () {
                    closeBtn.disabled = false;
                    var newTable = document.getElementById('mybodyTable');
                    var msgTable = document.createElement('TABLE');
                    msgTable.className = 'MessageBody';
                    msgTable.border = '2';
                    msgTable.borderColor = 'rgb(8, 191, 239';

                    var msgBody = document.createElement('TBODY');
                    msgTable.appendChild(msgBody);

                    var bodyRow = document.createElement('TR');
                    msgBody.appendChild(bodyRow);

                    var msgData = document.createElement('TD');
                    msgData.width = '700';
                    msgData.appendChild(document.createTextNode(emails.body))
                    bodyRow.appendChild(msgData);
                    main.appendChild(msgTable);

                    closeBtn.onclick = function () {
                        var emptyMsgs = document.getElementsByClassName('MessageBody');
                        emptyMsgs.remove();
                    }
                };
            };
                  /*  bodyBtn.onclick = function () {
                        if (bodyBtn.innerHTML === "Open Message") {
                            var bodyRow = bodyMsg.insertRow();
                            var cellBody = bodyRow.insertCell(0);
                            var cellData = document.createTextNode(emails.body);
                            cellBody.appendChild(cellData);
                            bodyBtn.innerHTML = "Close Message";
                        } else {
                            bodyMsg.deleteRow();
                            bodyBtn.innerHTML = "Open Message";
                        }
                    }*/ //OLD BODY BUTTON
                setInterval(function () {
                    alert("New Message!");
                    addRow(getNewMessage());
                    inboxCount += 1;
                    document.getElementById('boxCount').innerHTML = inboxCount + " Geemails";
                }, 10000);
        };
    </script>
	</head>
<body background="geePic.png">
    <h1>
        GEEMAIL
    </h1>
    <h2>
        Gee, mail sure is coming in...
        <label id="boxCount"></label>
        <button id="closeBtn" disabled="disabled">CLOSE ALL OPEN MESSAGES</button>
    </h2>
    <div class="container" id="main">
        <table id="inbox" class="inTable">
            <tr id="geeHead">
                <th class="hDate">Date</th>
                <th class="hSubject">Subject</th>
                <th class="hSender">Sender</th>
                <th class="hBody">Body</th>
            </tr>
        </table>
    </div>
</body>
</html>